---
name: github-workflow
description: Clone GitHub repositories, create feature branches, commit changes, and push to remote. Use when working with GitHub repos that need to be cloned locally, branched, and updated.
allowed-tools: Bash, Read, Write, Glob, Grep
---

# GitHub Workflow Skill

Manage GitHub repository operations for migration workflows including cloning, branching, committing, and pushing.

## Prerequisites

- GitHub CLI (`gh`) must be installed and authenticated
- Git must be configured with user credentials
- SSH or HTTPS access to target repositories

## Operations

### Clone Repository

Clone a GitHub repository to a local workspace:

```bash
# Clone to workspace
gh repo clone owner/repo /path/to/workspace/repo

# Or with git directly
git clone https://github.com/owner/repo.git /path/to/workspace/repo
```

### Batch Clone Multiple Repos

```bash
# Clone multiple repos in parallel
for repo in repo1 repo2 repo3; do
  gh repo clone owner/$repo /path/to/workspace/$repo &
done
wait
```

### Create Feature Branch

Create a standardized feature branch for migration work:

```bash
cd /path/to/repo
git checkout -b feature/spring-boot-4-migration
```

**Branch Naming Convention:**

- `feature/spring-boot-4-migration` - Main migration branch
- `feature/sb4-jackson-upgrade` - Jackson-specific changes
- `feature/sb4-security-upgrade` - Security-specific changes

### Commit Changes

Stage and commit migration changes with descriptive messages:

```bash
cd /path/to/repo

# Stage all changes
git add -A

# Commit with migration-specific message
git commit -m "chore: migrate to Spring Boot 4.x

- Update Spring Boot parent to 4.0.0
- Migrate Jackson 2.x to 3.x (groupId: tools.jackson)
- Update Spring Security 6 to 7 patterns
- Update Spring Cloud BOM to 2025.1.0

Generated by Spring Modernization Marketplace"
```

### Push Branch

Push the feature branch to remote:

```bash
cd /path/to/repo
git push -u origin feature/spring-boot-4-migration
```

## Workflow Integration

### Full Clone-to-Push Workflow

```bash
# 1. Clone
gh repo clone owner/repo /workspace/repo
cd /workspace/repo

# 2. Create branch
git checkout -b feature/spring-boot-4-migration

# 3. [Migration happens here via other skills]

# 4. Stage and commit
git add -A
git commit -m "chore: migrate to Spring Boot 4.x

<migration details>"

# 5. Push
git push -u origin feature/spring-boot-4-migration
```

### Parallel Clone Pattern

For migrating multiple repos efficiently:

```bash
WORKSPACE="/tmp/migration-workspace"
REPOS=("owner/repo1" "owner/repo2" "owner/repo3")

# Parallel clone
for repo in "${REPOS[@]}"; do
  name=$(basename $repo)
  gh repo clone $repo "$WORKSPACE/$name" &
done
wait

echo "All repos cloned to $WORKSPACE"
```

## Error Handling

### Clone Failures

```bash
# Check if repo exists and is accessible
gh repo view owner/repo --json name

# Handle authentication issues
gh auth status
gh auth login
```

### Push Failures

```bash
# Check remote status
git remote -v

# Verify branch doesn't exist
git ls-remote --heads origin feature/spring-boot-4-migration

# Force push if needed (with caution)
git push -u origin feature/spring-boot-4-migration --force-with-lease
```

### Branch Already Exists

```bash
# Delete and recreate
git branch -D feature/spring-boot-4-migration
git checkout -b feature/spring-boot-4-migration
```

## Output Format

Report repository status:

```json
{
  "repo": "owner/repo",
  "status": "cloned",
  "localPath": "/workspace/repo",
  "branch": "feature/spring-boot-4-migration",
  "remote": "origin"
}
```

## Critical Rules

1. **Always verify authentication** before cloning private repos
2. **Create backup branches** before making changes
3. **Use descriptive commit messages** that explain migration changes
4. **Never force push to main/master** branches
5. **Verify remote branch doesn't exist** before pushing
